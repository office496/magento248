<?php
/**
 * HyvÃ¤ Themes - Header adapted for ITILES Figma
 */

declare(strict_types=1);

use Hyva\Theme\Model\ViewModelRegistry;
use Hyva\Theme\ViewModel\HeroiconsOutline;
use Hyva\Theme\ViewModel\HeroiconsSolid;
use Hyva\Theme\ViewModel\HyvaCsp;
use Hyva\Theme\ViewModel\StoreConfig;
use Magento\Checkout\Block\Cart\Sidebar as SidebarCart;
use Magento\Framework\Escaper;
use Magento\Framework\View\Element\Template;

/** @var Escaper $escaper */
/** @var Template $block */
/** @var ViewModelRegistry $viewModels */
/** @var HyvaCsp $hyvaCsp */

/** @var HeroiconsOutline $heroicons */
$heroicons = $viewModels->require(HeroiconsOutline::class);

/** @var HeroiconsSolid $heroiconsSolid */
$heroiconsSolid = $viewModels->require(HeroiconsSolid::class);

/** @var StoreConfig $storeConfig */
$storeConfig = $viewModels->require(StoreConfig::class);
$showMiniCart = $storeConfig->getStoreConfig(SidebarCart::XML_PATH_CHECKOUT_SIDEBAR_DISPLAY);

?>
<?php $hyvaCsp->registerInlineScript() ?>

<header id="header" class="z-30 sticky top-0 backdrop-blur-sm bg-white/80 shadow-header" x-data="initHeader" @private-content-loaded.window="getData" @resize.window.debounce="checkHeaderSize">
  <div class="site-banner">Autumn Sale are reduceri de pana la <span class="font-semibold text-brand-accent">70%</span> la 800 articole cu livrare din stoc</div>

  <div class="container grid grid-cols-12 gap-x-4 gap-y-3.5 items-center py-3">
    <div class="col-span-2 flex items-center">
      <?= $block->getChildHtml('logo'); ?>
    </div>

    <div class="col-span-8">
      <form action="<?= $block->getUrl('catalogsearch/result') ?>" method="get" class="flex items-center gap-2">
        <input type="search" name="q" placeholder="Cauta gresie faianta sanitare mobilier" class="input" />
        <button type="submit" class="btn btn-primary" aria-label="Search">
          <?= $heroiconsSolid->searchHtml('w-5 h-5', 20, 20, ['aria-hidden' => 'true']) ?>
        </button>
      </form>
    </div>

    <div class="col-span-2 ml-auto flex items-center justify-end gap-3">
      <?= $block->getChildHtml('additional') ?>
      <?= $block->getChildHtml('customer') ?>
      <?php if ($showMiniCart): ?>
        <?= $block->getChildHtml('minicart') ?>
      <?php endif; ?>
    </div>
  </div>

  <?= $block->getChildHtml('mobilemenu') ?>
</header>
